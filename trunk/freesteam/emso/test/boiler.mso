#* 
    freesteam stream integration for use in steam system calculations
    
    Based on steam.mso by Rafael de Pelegrini Soares,

    Copyright 2002-2005 Rafael de Pelegrini Soares.
    Modified by John Pye 2005 http://freesteam.sf.net
    
    This copyright statement must not be deleted and must be
    included in any modification or adaptation of this Model.
*#

using "steamequipment";

#*
    Boiler

    Specify outlet pressure plus q or outlet temperature
*#
Model Boiler as SteamEquipment_ph # 7
    
    VARIABLES
    q   as HeatRate;
	Dp  as PressureDifference;
	
	CONNECTIONS
	# In.mdot to Out.mdot;
	
    EQUATIONS   
	
	"Mass flow"
	In.mdot = Out.mdot;
	
    "Energy balance"
    q = Out.mdot * Out.h - In.mdot * In.h;
    
    "Pressure difference"
    Dp = Out.p - In.p;
    
end

#*
    Boiler
*#
Model Boiler_pT as SteamEquipment_pT # 7
    
    VARIABLES
    q   as HeatRate;
	Dp  as PressureDifference;
	
	CONNECTIONS
	# In.mdot to Out.mdot;
	
    EQUATIONS
	"Mass flow"
	In.mdot = Out.mdot;
	
    "Energy balance"
    q = In.mdot * Out.h - In.mdot * In.h;
    
    "Pressure difference"
    Dp = Out.p - In.p;
    
end

Model BoilerWithLoss as Boiler # 7
		
	PARAMETERS freesteam as CalcObject(File="emsofreesteam");
	
    VARIABLES
    K as Positive(Brief="Minor loss coefficient for boiler");
	A_1 as Area(Brief="Boiler inlet pipe area");
		
    EQUATIONS
	"Pressure drop"
	Dp = K * In.mdot^2 / freesteam.rho_ph(In.p,In.h) / A_1^2;
    
end