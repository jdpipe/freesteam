#* 
	Rankine Cycle

	Note the method of connecting the cycle end back to the start. 
	Because of uniform flow through all components, mass flow must not be connected back to the start, else a singular Jacobian is formed.
	
	John Pye 2005 http://freesteam.sf.net
*#

using "streams";
using "turbine";
using "boiler";
using "pump";
using "condenser";
using "throttle";

Model Rankine
	
	PARAMETERS
	freesteam as CalcObject(File="emsofreesteam");
	
    VARIABLES
	mdot as MassFlowRate;
	
    BO	as Boiler_pT;
	TU	as Turbine;
	CO	as Condenser;
	PU 	as PumpWithCurve;
	
	CONNECTIONS
	BO.Out	to	TU.In;
	TU.Out	to  CO.In;
	CO.Out	to  PU.In;
	
	SPECIFY
	BO.In.mdot = mdot;
	
	PU.Out.p = BO.In.p;
	PU.Out.h = BO.In.h;
	# PU.Out.mdot = BO.In.mdot; # <-- this is redundant since all the mess flows are already equated!
	
	[BO.In.T, BO.In.s]=freesteam.Ts_ph(BO.In.p,BO.In.h);

	#"System-wide energy conservation"
	# BO.q + PU.P = CO.q + TU.P;
	
end
