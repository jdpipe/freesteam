#* 
	freesteam stream integration for use in steam system calculations
	
	Based on steam.mso by Rafael de Pelegrini Soares,
	Copyright 2002-2005 Rafael de Pelegrini Soares.

	Modified by John Pye 2005 http://freesteam.sf.net
*#

using "streams";
using "condenser";

#*
	Simple condenser test: specify inlet andoutlet conditions

	THIS FLOWSHEET WORKS
*#
FlowSheet CondenserTest
	
	PARAMETERS
	freesteam as CalcObject(File="emsofreesteam");
	
	DEVICES
	S as Stream_pT;
	CO as Condenser_pT;
	#CO as Condenser;
	
	CONNECTIONS
	S to CO.In; # (-5) - 0        = -5 DF
	
	SPECIFY
	S.mdot = 1 * "kg/s";
	S.p = 2.0 * "bar";
	S.T = (150 + 273.15) * "K";
	
	CO.Out.p = 1.0 * "bar";
	CO.Out.T = (40 + 273.15) * "K";
	
	OPTIONS
	mode = "steady";
	outputLevel = "all";
end

FlowSheet CondenserTest1
	
	PARAMETERS
	freesteam as CalcObject(File="emsofreesteam");
	
	DEVICES
	S as Stream_pT;
	CO as Condenser_pT;
	#CO as Condenser;
	
	CONNECTIONS
	S to CO.In; # (-5) - 0        = -5 DF
	
	SPECIFY
	S.mdot = 1 * "kg/s";
	S.p = 2.0 * "bar";
	S.T = (150 + 273.15) * "K";
	
	CO.Qdot = -4.2 * "kW";
	CO.Dp = - 1.0 * "bar";
		
	GUESS 
	CO.Out.T=(151 + 273.15) * "K";
	
	# FIXME: [rafael] this is required when DT is specified instead of q:
	# CO.Out.h = 300 * "kJ/kg";
	
	OPTIONS
	mode = "steady";
	outputLevel = "all";
end

#*
	Condenser specified in terms of UA and outlet pressure

	THIS FLOWSHEET WORKS
*#
FlowSheet CondenserTest2
	
	DEVICES
	S as Stream_pT; # 5 - 2       = 3
	CO as Condenser_pT; # 14 - 5 - 2 = 7
	#CO as Condenser;
	
	CONNECTIONS
	S to CO.In; # (-5) - 0        = -5 DF
	
	SPECIFY
	S.mdot = 1 * "kg/s";
	S.p = 2.0 * "bar";
	S.T = (150 + 273.15) * "K";
	
	CO.UA = 3090 * "kW/K";
	CO.Out.p = 1 * "bar";
	
	GUESS 
	CO.Out.h = 500 * "kJ/kg";
	# FIXME: [rafael] this is required when DT is specified instead of q:
	# CO.Out.h = 300 * "kJ/kg";
	
	OPTIONS
	mode = "steady";
	outputLevel = "all";
end

#*
	Similar to TestCondenser2 but different operation conditions
	
	THIS FLOWSHEET WORKS
*#
FlowSheet CondenserTest3
	
	PARAMETERS
	freesteam as CalcObject(File="emsofreesteam");
	
	DEVICES
	S as Stream_ph; # 5 - 2       = 3
	CO as Condenser; # 14 - 5 - 2 = 7
	
	CONNECTIONS
	S to CO.In; # (-5) - 0        = -5 DF
	
	SPECIFY
	S.mdot = 30 * "kg/s";
	S.h = 2000 * "kJ/kg";
	S.T = (300 + 273.15) * "K";
	
	#CO.UA = 140 * "kW/K";
	CO.Out.h = 700 * "kJ/kg";
	CO.Out.p = 0.05 * "bar";
	
	OPTIONS
	mode = "steady";
	outputLevel = "all";
end

#*
	Test condenser with pressure loss

	THIS FLOWSHEET WORKS
*#
FlowSheet CondensertWithLossTest
	
	DEVICES
	S as Stream_ph;
	CO as CondenserWithLoss;
	
	CONNECTIONS
		S to CO.In;
	
	SPECIFY
	S.mdot=30 * "kg/s";
	S.h = 2000 * "kJ/kg";
	S.p = 60 * "bar";
		
	CO.K = 0.5;
	CO.A_1 = 3.1415926 * (0.2 * "m")^2 / 4;
	
	CO.UA = 140 *  "kW/K";
	
	OPTIONS
	mode="steady";
	outputLevel="all";

end
