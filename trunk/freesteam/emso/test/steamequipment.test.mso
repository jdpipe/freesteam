#*
	Test a totally trivial steam equipment connection: an equipment that is a zero-loss pipe, that passes through
	its input state to its output.
*#

using "steamequipment";
using "newtypes";
using "streams";

#*
	Simple steady-state GIGO system!
	
	THIS FLOWSHEET WORKS
*#
FlowSheet SteamEquipmentTest # 0

	DEVICES 
	S1 as Stream_pT; # 5
	S2 as Stream; # 5
	EQ as SteamEquipment; # 5
	
	CONNECTIONS # -10
	S1 to EQ.In;
	EQ.Out to S2;
	
	SPECIFY # -5
	S1.p = 10 * "bar";
	S1.T = 300 * "K";
	S1.mdot = 5 * "kg/s";
	
	EQ.In.p = EQ.Out.p;
	EQ.In.s = EQ.Out.s;
	EQ.In.T = EQ.Out.T;
	EQ.In.mdot= EQ.Out.mdot;
	EQ.H = 0 * "J";
	EQ.Qdot = 0 * "W";
	EQ.Wdot = 0 * "W";
	
	OPTIONS
	mode = "steady";
	outputLevel = "all";
	LASolver = "dense";

end

#*
	First try at a trivial transient simulation
	
	DOESN'T WORK
*#
FlowSheet SteamEquipmentTest2

	DEVICES
	S1 as Stream_pT;
	S2 as Stream;
	EQ as SteamEquipment;
	
	CONNECTIONS # -10
	S1 to EQ.In;
	EQ.Out to S2;
	
	EQUATIONS
	#*if time < 10 then
		S1.p = 10 * "bar";
	else
		S1.p = 20 * "bar";
	end
	*#
	S1.p = 10* "bar";

	SPECIFY
	S1.T = 300 * "K";
	S1.mdot = 0.1 * "kg/s";

	EQ.In.p = EQ.Out.p;
	EQ.In.s = EQ.Out.s;
	EQ.In.T = EQ.Out.T;
	EQ.In.mdot= EQ.Out.mdot;
	EQ.Qdot = 100 * "kJ/kg" * 0.1 * "kg/s";
	EQ.Wdot = 0 * "W";
	EQ.H = 0 * "J";
	
	OPTIONS
	outputLevel = "all";
	LASolver = "dense";	
	differentiation="numeric";

end
