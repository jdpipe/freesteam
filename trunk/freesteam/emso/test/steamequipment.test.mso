#*
	Test of SteamEquipment Model
	
	Really just tests how the SteamEquipment can be connected together with other streams
*#

using "newtypes";
using "streams";

Model SteamEquipment_Trivial # 5
	
	PARAMETERS
	freesteam as CalcObject(File = "emsofreesteam");
	
	VARIABLES
	In as Stream; # 5
	Out as Stream; # 5
		
	EQUATIONS # -5
	Out.p = In.p - 3 * "bar";
	Out.h = In.h + 100 * "kJ/kg";
	Out.mdot = In.mdot;
	[Out.T, Out.p] = freesteam.Ts_ph(Out.p,Out.h);

end
	
FlowSheet SteamEquipment_Test # 0

	PARAMETERS
	freesteam as CalcObject(File = "emsofreesteam");
	inputTemperature as Temperature(Lower=273.15, Upper = 1073.15, Default = 350, Unit="K");
	
	DEVICES 
	S1 as Stream; # 5
	S2 as Stream; # 5
	EQ as SteamEquipment_Trivial; # 5
	
	CONNECTIONS # -10
	S1 to EQ.In;
	EQ.Out to S2;
	
	SET
	inputTemperature = 300 * "K";

	SPECIFY # -5
	S1.p = 10 * "bar";
	S1.T = inputTemperature;
	S1.mdot = 5 * "kg/s";
	
	[S1.h, S1.s] = freesteam.hs_pT(S1.p,inputTemperature);
	
	OPTIONS
	mode = "steady";
	outputLevel = "all";
	LASolver = "dense";

end
